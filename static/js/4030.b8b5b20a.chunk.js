"use strict";(self.webpackChunkn2_trees=self.webpackChunkn2_trees||[]).push([[4030],{19747:(e,t,n)=>{n.d(t,{c:()=>s});var i=n(31633),r=n(65308);function s(e){const t="metric";if(null==e)return t;const n=e.map,s=(n&&"portalItem"in n?n.portalItem?.portal:null)??r.A.getDefault();switch(s.user?.units??s.units){case t:return t;case"english":return"imperial"}return(0,i.jM)(e.spatialReference)??t}},38983:(e,t,n)=>{function i(e,t,n){n=n||2;var i,s,a,l,u,c,h,d=t&&t.length,v=d?t[0]*n:e.length,y=r(e,0,v,n,!0),f=[];if(!y||y.next===y.prev)return f;if(d&&(y=p(e,t,y,n)),e.length>80*n){i=a=e[0],s=l=e[1];for(var g=n;g<v;g+=n)(u=e[g])<i&&(i=u),(c=e[g+1])<s&&(s=c),u>a&&(a=u),c>l&&(l=c);h=0!==(h=Math.max(a-i,l-s))?1/h:0}return o(y,f,n,i,s,h),f}function r(e,t,n,i,r){var s,o;if(r===A(e,t,n,i)>0)for(s=t;s<n;s+=i)o=R(s,e[s],e[s+1],o);else for(s=n-i;s>=t;s-=i)o=R(s,e[s],e[s+1],o);if(o&&C(o,o.next)){var a=o.next;k(o),o=a}return o}function s(e,t){if(!e)return e;t||(t=e);var n,i=e;do{if(n=!1,i.steiner||!C(i,i.next)&&0!==x(i.prev,i,i.next))i=i.next;else{var r=i.prev;if(k(i),(i=t=r)===i.next)break;n=!0}}while(n||i!==t);return t}function o(e,t,n,i,r,p,h){if(e){!h&&p&&f(e,i,r,p);for(var d,v,y=e;e.prev!==e.next;)if(d=e.prev,v=e.next,p?l(e,i,r,p):a(e))t.push(d.i/n),t.push(e.i/n),t.push(v.i/n),k(e),e=v.next,y=v.next;else if((e=v)===y){h?1===h?o(e=u(s(e),t,n),t,n,i,r,p,2):2===h&&c(e,t,n,i,r,p):o(s(e),t,n,i,r,p,1);break}}}function a(e){var t=e.prev,n=e,i=e.next;if(x(t,n,i)>=0)return!1;for(var r=e.next.next;r!==e.prev;){if(_(t.x,t.y,n.x,n.y,i.x,i.y,r.x,r.y)&&x(r.prev,r,r.next)>=0)return!1;r=r.next}return!0}function l(e,t,n,i){var r=e.prev,s=e,o=e.next;if(x(r,s,o)>=0)return!1;for(var a=r.x<s.x?r.x<o.x?r.x:o.x:s.x<o.x?s.x:o.x,l=r.y<s.y?r.y<o.y?r.y:o.y:s.y<o.y?s.y:o.y,u=r.x>s.x?r.x>o.x?r.x:o.x:s.x>o.x?s.x:o.x,c=r.y>s.y?r.y>o.y?r.y:o.y:s.y>o.y?s.y:o.y,p=g(a,l,t,n,i),h=g(u,c,t,n,i),d=e.prevZ,v=e.nextZ;d&&d.z>=p&&v&&v.z<=h;){if(d!==e.prev&&d!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;if(d=d.prevZ,v!==e.prev&&v!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&x(v.prev,v,v.next)>=0)return!1;v=v.nextZ}for(;d&&d.z>=p;){if(d!==e.prev&&d!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,d.x,d.y)&&x(d.prev,d,d.next)>=0)return!1;d=d.prevZ}for(;v&&v.z<=h;){if(v!==e.prev&&v!==e.next&&_(r.x,r.y,s.x,s.y,o.x,o.y,v.x,v.y)&&x(v.prev,v,v.next)>=0)return!1;v=v.nextZ}return!0}function u(e,t,n){var i=e;do{var r=i.prev,o=i.next.next;!C(r,o)&&M(r,i,i.next,o)&&P(r,o)&&P(o,r)&&(t.push(r.i/n),t.push(i.i/n),t.push(o.i/n),k(i),k(i.next),i=e=o),i=i.next}while(i!==e);return s(i)}function c(e,t,n,i,r,a){var l=e;do{for(var u=l.next.next;u!==l.prev;){if(l.i!==u.i&&w(l,u)){var c=S(l,u);return l=s(l,l.next),c=s(c,c.next),o(l,t,n,i,r,a),void o(c,t,n,i,r,a)}u=u.next}l=l.next}while(l!==e)}function p(e,t,n,i){var o,a,l,u=[];for(o=0,a=t.length;o<a;o++)(l=r(e,t[o]*i,o<a-1?t[o+1]*i:e.length,i,!1))===l.next&&(l.steiner=!0),u.push(m(l));for(u.sort(h),o=0;o<u.length;o++)n=s(n=v(u[o],n),n.next);return n}function h(e,t){return e.x-t.x}function d(e){if(e.next.prev===e)return e;let t=e;for(;;){const n=t.next;if(n.prev===t||n===t||n===e)break;t=n}return t}function v(e,t){var n=function(e,t){var n,i=t,r=e.x,s=e.y,o=-1/0;do{if(s<=i.y&&s>=i.next.y&&i.next.y!==i.y){var a=i.x+(s-i.y)*(i.next.x-i.x)/(i.next.y-i.y);if(a<=r&&a>o){if(o=a,a===r){if(s===i.y)return i;if(s===i.next.y)return i.next}n=i.x<i.next.x?i:i.next}}i=i.next}while(i!==t);if(!n)return null;if(r===o)return n;var l,u=n,c=n.x,p=n.y,h=1/0;i=n;do{r>=i.x&&i.x>=c&&r!==i.x&&_(s<p?r:o,s,c,p,s<p?o:r,s,i.x,i.y)&&(l=Math.abs(s-i.y)/(r-i.x),P(i,e)&&(l<h||l===h&&(i.x>n.x||i.x===n.x&&y(n,i)))&&(n=i,h=l)),i=i.next}while(i!==u);return n}(e,t);if(!n)return t;var i=S(n,e),r=s(n,n.next);let o=d(i);return s(o,o.next),r=d(r),d(t===n?r:t)}function y(e,t){return x(e.prev,e,t.prev)<0&&x(t.next,e,e.next)<0}function f(e,t,n,i){var r=e;do{null===r.z&&(r.z=g(r.x,r.y,t,n,i)),r.prevZ=r.prev,r.nextZ=r.next,r=r.next}while(r!==e);r.prevZ.nextZ=null,r.prevZ=null,function(e){var t,n,i,r,s,o,a,l,u=1;do{for(n=e,e=null,s=null,o=0;n;){for(o++,i=n,a=0,t=0;t<u&&(a++,i=i.nextZ);t++);for(l=u;a>0||l>0&&i;)0!==a&&(0===l||!i||n.z<=i.z)?(r=n,n=n.nextZ,a--):(r=i,i=i.nextZ,l--),s?s.nextZ=r:e=r,r.prevZ=s,s=r;n=i}s.nextZ=null,u*=2}while(o>1)}(r)}function g(e,t,n,i,r){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*r)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-i)*r)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function m(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function _(e,t,n,i,r,s,o,a){return(r-o)*(t-a)-(e-o)*(s-a)>=0&&(e-o)*(i-a)-(n-o)*(t-a)>=0&&(n-o)*(s-a)-(r-o)*(i-a)>=0}function w(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&M(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(P(e,t)&&P(t,e)&&function(e,t){var n=e,i=!1,r=(e.x+t.x)/2,s=(e.y+t.y)/2;do{n.y>s!=n.next.y>s&&n.next.y!==n.y&&r<(n.next.x-n.x)*(s-n.y)/(n.next.y-n.y)+n.x&&(i=!i),n=n.next}while(n!==e);return i}(e,t)&&(x(e.prev,e,t.prev)||x(e,t.prev,t))||C(e,t)&&x(e.prev,e,e.next)>0&&x(t.prev,t,t.next)>0)}function x(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function C(e,t){return e.x===t.x&&e.y===t.y}function M(e,t,n,i){var r=Z(x(e,t,n)),s=Z(x(e,t,i)),o=Z(x(n,i,e)),a=Z(x(n,i,t));return r!==s&&o!==a||!(0!==r||!b(e,n,t))||!(0!==s||!b(e,i,t))||!(0!==o||!b(n,e,i))||!(0!==a||!b(n,t,i))}function b(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function Z(e){return e>0?1:e<0?-1:0}function P(e,t){return x(e.prev,e,e.next)<0?x(e,t,e.next)>=0&&x(e,e.prev,t)>=0:x(e,t,e.prev)<0||x(e,e.next,t)<0}function S(e,t){var n=new E(e.i,e.x,e.y),i=new E(t.i,t.x,t.y),r=e.next,s=t.prev;return e.next=t,t.prev=e,n.next=r,r.prev=n,i.next=n,n.prev=i,s.next=i,i.prev=s,i}function R(e,t,n,i){var r=new E(e,t,n);return i?(r.next=i.next,r.prev=i,i.next.prev=r,i.next=r):(r.prev=r,r.next=r),r}function k(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function E(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function A(e,t,n,i){for(var r=0,s=t,o=n-i;s<n;s+=i)r+=(e[o]-e[s])*(e[s+1]+e[o+1]),o=s;return r}n.d(t,{e:()=>i}),i.deviation=function(e,t,n,i){var r=t&&t.length,s=r?t[0]*n:e.length,o=Math.abs(A(e,0,s,n));if(r)for(var a=0,l=t.length;a<l;a++){var u=t[a]*n,c=a<l-1?t[a+1]*n:e.length;o-=Math.abs(A(e,u,c,n))}var p=0;for(a=0;a<i.length;a+=3){var h=i[a]*n,d=i[a+1]*n,v=i[a+2]*n;p+=Math.abs((e[h]-e[v])*(e[d+1]-e[h+1])-(e[h]-e[d])*(e[v+1]-e[h+1]))}return 0===o&&0===p?0:Math.abs((p-o)/o)},i.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},i=0,r=0;r<e.length;r++){for(var s=0;s<e[r].length;s++)for(var o=0;o<t;o++)n.vertices.push(e[r][s][o]);r>0&&(i+=e[r-1].length,n.holes.push(i))}return n}},43927:(e,t,n)=>{n.d(t,{L:()=>l,l:()=>h});var i=n(98773),r=n(19276),s=n(54901),o=n(50346),a=n(68134);function l(e,t,n){const i=n?.createCollection?.()??new r.A,s=n?.recycleItems?new u:null,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e?.length)return;const n=i.splice(t,e.length);s?s.processRemoved(e):n.forEach(p)},l=function(e){let n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e?.length)return;const r=[];for(const i of e){const e=s?.use(i);if(e)r.push(e);else{const e=t(i);s?.register(i,e),r.push(e)}}i.addMany(r,n)},c=(0,a.on)(e,"after-splice",e=>{let{added:t,start:n,removed:i}=e;o(i,n),l(t,n)},{sync:!0,onListenerRemove:e=>o(e.items),onListenerAdd:e=>l(e.items)});return i.addHandles(c),i}class u{constructor(){this._originalToMapped=new Map,this._removedItemCandidates=new Set,this._garbageCollectionQueued=!1}processRemoved(e){if(!e?.length)return;const{_removedItemCandidates:t}=this;for(const n of e)this._getItem(n)?.markRemoved()&&(t.add(n),this._queueGarbageCollection())}use(e){const t=this._getItem(e);return t&&(t.removed=!1),t?.item}register(e,t){this._originalToMapped.set(e,new c(t))}_getItem(e){return this._originalToMapped.get(e)}_queueGarbageCollection(){this._garbageCollectionQueued||(this._garbageCollectionQueued=!0,queueMicrotask(()=>this._garbageCollectCandidates()))}_garbageCollectCandidates(){this._garbageCollectionQueued=!1;const{_removedItemCandidates:e}=this,t=Array.from(e);e.clear(),t.forEach(e=>this._garbageCollectIfRemoved(e))}_garbageCollectIfRemoved(e){const{_originalToMapped:t}=this,n=this._getItem(e);n?.removed&&(p(n.item),t.delete(e))}}class c{constructor(e){this.item=e,this.removed=!1}markRemoved(){return this.removed=!0,!0}}function p(e){"object"==typeof e&&e&&("destroy"in e&&"function"==typeof e.destroy?e.destroy():(0,s.wt)(e))}function h(e,t,n){const a=new r.A,u=l(e,e=>(0,i.UT)(async n=>{const i=await t(e,n);if((0,o.G4)(n))throw p(i),(0,o.NK)();return i}),n),c=()=>null,h=async e=>{const t=await e.promise,n=u.indexOf(e);n<0||a.splice(n,1,t)};a.addMany(u.items.map(c));for(const i of u)(0,o.QZ)(h(i));const d=u.on("after-splice",e=>{let{added:t,start:n,deleteCount:i}=e;const r=a.splice(n,i);for(const s of r)p(s);if(t?.length){a.addMany(t.map(c),n);for(const e of t)(0,o.QZ)(h(e))}});return a.addHandles([(0,s.DQ)(u),d]),a}},59145:(e,t,n)=>{n.r(t),n.d(t,{default:()=>vt});var i=n(6326),r=n(50076),s=n(46053),o=(n(81806),n(76460),n(47249),n(87990)),a=n(54099),l=n(54901),u=n(91291);let c=class extends((0,u.g)(a.nJ)){constructor(){super(...arguments),this.parent=null,this._userInteractive=!1,this._interactiveViewModelCount=0}get interactive(){return this._interactiveViewModelCount>0||this._userInteractive}set interactive(e){this._userInteractive=e}get updating(){return!1}get visible(){return(this.parent?.visible&&!this.parent.suspended)??!0}set visible(e){this._overrideIfSome("visible",e)}forceInteractive(){return this._interactiveViewModelCount++,(0,l.hA)(()=>this._interactiveViewModelCount--)}};(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],c.prototype,"parent",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],c.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)({type:Boolean})],c.prototype,"interactive",null),(0,i.Cg)([(0,s.MZ)()],c.prototype,"_userInteractive",void 0),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],c.prototype,"updating",null),(0,i.Cg)([(0,s.MZ)()],c.prototype,"visible",null),(0,i.Cg)([(0,s.MZ)()],c.prototype,"_interactiveViewModelCount",void 0),c=(0,i.Cg)([(0,o.$)("esri.views.analysis.AnalysisView")],c);let p=class extends c{};p=(0,i.Cg)([(0,o.$)("esri.views.2d.analysis.AnalysisView2D")],p);var h=n(91967),d=n(68134);let v=class extends h.A{constructor(e){super(e)}initialize(){this.addHandles(function(e){return(0,l.vE)([(0,d.wB)(()=>{const{analysis:t,sketchGraphic:n,toolState:i,visible:r}=e.analysisViewData,{geometryVisualizationVisible:s}=t.viewOptions;return{geometryVisualizationVisible:s,geometry:t.geometry,sketchGraphic:n,toolState:i,visible:r}},t=>{let{geometryVisualizationVisible:n,sketchGraphic:i,toolState:r,visible:s}=t;if(e.remove(),s)return n&&null!=i&&"reshaping"!==r&&"sketching"!==r?e.show(i):void 0},d.pc)])}({analysisViewData:this.analysisViewData,remove:()=>{},show:()=>{}}))}get updating(){return!1}};(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],v.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],v.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,s.MZ)()],v.prototype,"updating",null),v=(0,i.Cg)([(0,o.$)("esri.views.2d.analysis.ElevationProfile.ElevationProfileInputVisualization2D")],v);var y=n(39356),f=n(59784),g=n(79468),m=n(63733),_=n(89465),w=n(31633);let x={noDataValue:-5e5,defaultQueryOptions:()=>({noDataValue:x.noDataValue,demResolution:"auto",maximumAutoTileRequests:150,ignoreInvisibleLayers:!0,signal:null}),updateThrottleMillis:100,delayAfterPreviewMillis:500,defaultDemResolution:(0,w.oU)(10,"centimeters","meters"),densificationMaxSamples:3e3,largeChartSamples:1e4,maxTotalSamples:1e5,maxChartRatio:300,minSlopeSampleDistance:10,formatPrecision:1,profileLinesUpdateThrottleMillis:100,hoveredPointsStyle:{size:14,borderStyle:"solid",borderWidth:3,borderColor:"#ffffff",boxShadow:"0px 0px 0px 5px rgba(255,255,255,0.2)"}};function C(){return x}const M={progress:1,hasZ:!1,samples:[],statistics:null,spatialReference:null};var b=n(48384);let Z=class extends h.A{constructor(e){super(e),this._graphic=new y.A,this._layer=new m.A({listMode:"hide",internal:!0}),this._updateGeometryThrottled=(0,g.n)(e=>{if(!e)return void(this._graphic.visible=!1);const t=this._layer,n=this.view.map?.layers;n&&(n.includes(t)||n.add(t),n.reorder(t,0)),this._graphic.visible=!0,this._graphic.geometry=function(e,t){e??=[];const n=e.length-1,i=[];let r=[];for(let s=0;s<=n;s++){const{x:t,y:o,z:a}=e[s];null!=a&&r.push([t,o,a]),s!==n&&null!=a||!r.length||(i.push(r),r=[])}return(0,b.LZ)(i,t,!0)}(e.samples,e.spatialReference)},C().profileLinesUpdateThrottleMillis)}initialize(){this._layer.add(this._graphic),this.addHandles([(0,d.z7)(()=>!this.analysisViewData.visible,()=>{this._graphic.visible=!1}),(0,d.wB)(()=>this._colorUpdateParameters,e=>this._updateColor(e),d.pc),(0,d.wB)(()=>this.analysisViewData.analysis.geometry,()=>{this._graphic.visible=!1},d.pc),(0,d.wB)(()=>this._geometryUpdateParameters,e=>this._updateGeometryThrottled(e),d.pc),this._updateGeometryThrottled])}destroy(){this.view.map?.remove(this._layer),this._layer.destroy(),this._graphic.destroy()}get updating(){return this._updateGeometryThrottled.hasPendingUpdates()}get _result(){const{analysisViewData:e}=this;return e.visible?e.results.find(e=>{let{available:t,computation:n,rawResult:i}=e;return t&&n.profile.viewOptions.lineVisible&&!0===i?.hasZ}):null}get _geometryUpdateParameters(){const e=this._result;return 1!==e?.progress?null:{samples:e.samples,spatialReference:this.view.spatialReference}}get _colorUpdateParameters(){const e=this._result?.computation.profile.color;return e?{color:e.toArray(),contrastColor:(0,f.bJ)(e).toArray()}:null}_updateColor(e){e&&(this._graphic.symbol=new _.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",capStyle:"Butt",color:e.color,effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],joinStyle:"Round",width:1.5},{type:"CIMSolidStroke",capStyle:"Butt",color:e.contrastColor,joinStyle:"Round",width:1.5}]}}}))}};(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Z.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Z.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,s.MZ)()],Z.prototype,"updating",null),(0,i.Cg)([(0,s.MZ)()],Z.prototype,"_result",null),(0,i.Cg)([(0,s.MZ)()],Z.prototype,"_geometryUpdateParameters",null),(0,i.Cg)([(0,s.MZ)()],Z.prototype,"_colorUpdateParameters",null),Z=(0,i.Cg)([(0,o.$)("esri.views.2d.analysis.ElevationProfile.ElevationProfileLineVisualization2D")],Z);var P=n(19276),S=n(69539),R=n(56611);let k=class extends h.A{constructor(e){super(e),this.position=null,this.color=new S.A("#ffffff"),this.element=function(){const e=document.createElement("div"),{size:t,borderStyle:n,borderColor:i,borderWidth:r,boxShadow:s}=C().hoveredPointsStyle,{style:o}=e;return o.display="block",o.position="absolute",o.top="0",o.left="0",o.contain="strict",o.boxSizing="border-box",o.width=`${t}px`,o.height=`${t}px`,o.marginTop=`-${t/2}px`,o.marginLeft=`-${t/2}px`,o.border=`${n} ${r}px ${i}`,o.borderRadius=`${t}px`,o.boxShadow=s,e}()}initialize(){this.addHandles([(0,d.wB)(()=>this._screenLocation,e=>{e&&(this.element.style.transform=`translate(${e.x}px, ${e.y}px)`)},d.pc),(0,d.wB)(()=>this.color.toCss(),e=>{this.element.style.background=e},d.pc)]),this.view.surface?.appendChild(this.element)}destroy(){this.element.remove()}get _screenLocation(){const{position:e,view:t}=this;"3d"===t.type?(t.commitProperty("size"),t.commitProperty("camera")):t.commitProperty("center");const n=t?.spatialReference,i=n?(0,R.projectOrLoad)(e,n).geometry:null;return i&&t?.ready?t.toScreen(i):null}};(0,i.Cg)([(0,s.MZ)()],k.prototype,"position",void 0),(0,i.Cg)([(0,s.MZ)({type:S.A})],k.prototype,"color",void 0),(0,i.Cg)([(0,s.MZ)()],k.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)()],k.prototype,"_screenLocation",null),k=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointVisualization")],k);let E=class extends h.A{constructor(e){super(e),this._hoveredPoints=new P.A}initialize(){const{analysisViewData:e}=this,{analysis:t}=e;this.addHandles([(0,d.wB)(()=>{const{hoveredPoints:n,visible:i,updating:r}=e;return i?r?null:n.map((e,n)=>{const i=t.profiles.at(n);return!0===i?.viewOptions.hoveredPointVisible&&null!=e?{hoveredPoint:e,color:i.color}:null}).filter(e=>!!e):[]},e=>this._update(e),d.pc),(0,d.wB)(()=>t.geometry,()=>this._update([]),d.pc)])}destroy(){this._hoveredPoints.drain(e=>e.destroy())}get updating(){return!1}_update(e){if(!e)return;const{view:t,_hoveredPoints:n}=this,i=e.length;for(;n.length>i;)n.pop()?.destroy();for(;n.length<i;){const e=new k({view:t});n.push(e)}for(let r=0;r<i;++r){const t=e[r],s=n.at(i-1-r);s.position=t.hoveredPoint,s.color=t.color}}};(0,i.Cg)([(0,s.MZ)()],E.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)()],E.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,s.MZ)()],E.prototype,"_hoveredPoints",void 0),(0,i.Cg)([(0,s.MZ)()],E.prototype,"updating",null),E=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileHoveredPointsVisualization")],E);let A=class extends h.A{constructor(e){super(e)}initialize(){const{view:e,analysisViewData:t}=this;this._hoveredPointsVisualization=new E({view:e,analysisViewData:t}),this._inputVisualization=new v({view:e,analysisViewData:t}),this._lineVisualization=new Z({view:e,analysisViewData:t})}destroy(){this._inputVisualization.destroy(),this._hoveredPointsVisualization.destroy(),this._lineVisualization.destroy()}get updating(){return this._hoveredPointsVisualization.updating||this._inputVisualization.updating||this._lineVisualization.updating}};(0,i.Cg)([(0,s.MZ)()],A.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)()],A.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,s.MZ)()],A.prototype,"updating",null),A=(0,i.Cg)([(0,o.$)("esri.views.2d.analysis.ElevationProfile.ElevationProfileVisualization2D")],A);var D=n(18690),V=n(98773);function T(e,t){let n,i=!1;return function(){for(var r=arguments.length,s=new Array(r),o=0;o<r;o++)s[o]=arguments[o];const a=e.apply(this,s);return i&&void 0!==n&&t?.(n,a)?n:(i=!0,n=a,a)}}var G=n(53084),z=n(53521),I=n(43927),O=n(30726),L=n(50346);class q{constructor(e){this._store=e}destroy(){this._store.destroy()}get(e){return this._store.get(e)}put(e,t){this._store.put(e,t)}}var U=n(12482),j=n(19747),H=n(731);class F extends r.A{constructor(e,t,n){super(e,t,n),this.name="unknown",this.name=e}}class $ extends F{constructor(){super("too-complex","The input geometry has too many points.")}}class B extends F{constructor(){super("invalid-geometry","The input geometry is invalid.")}}class N extends F{constructor(){super("elevation-query-error","Error querying elevation from provider.")}}class Q extends F{constructor(){super("unknown","Unknown error.")}}var W=n(15941),X=n(66388),J=n(5262),K=n(80963),Y=n(19555),ee=n(20664),te=n(23701),ne=n(13312),ie=n(7137);async function re(e,t,i,r,s,o,a){let l,u,c;const p=e.spatialReference,h=p.isGeographic||p.isWebMercator;let d=0;if(!h){const{execute:t}=await n.e(9227).then(n.bind(n,89227));(0,L.Te)(a),d=t(e,{unit:"meters"}),(0,L.Te)(a)}const v=1/(0,w.GA)(r);if(h){await(0,R.initializeProjection)([{source:p,dest:r},{source:p,dest:ne.A.WGS84}],a);const n=function(e){return(0,ie.TT)(e.spatialReference)?e:(0,R.project)(e,ne.A.WGS84)}(e);l=(0,ie.l1)([n],"meters")[0];const h=se(l,s);if(Ce(e,l,h)>o)throw new $;const d=oe(n,t,i);({densifiedPath:u,distances:c}=function(e,t,n){const{hasZ:i}=e;return ve(e,t,n,ye,i?me:ge)}(d,h,v)),u=(0,R.project)(u,r)}else{await(0,R.initializeProjection)([{source:p,dest:r}],a),l=d;const n=se(l,s);if(Ce(e,l,n)>o)throw new $;const h=oe(e,t,i);({densifiedPath:u,distances:c}=function(e,t,n){const{hasZ:i}=e;return ve(e,t,n,fe,i?we:_e)}(h,n,v)),(0,L.Te)(a),u=(0,R.project)(u,r)}return{densifiedPath:u,pathLength:l*v,distances:c}}function se(e,t){const n=e/t.densificationMaxSamples;return Math.max(t.samplingDistance,n)}function oe(e,t,n){if(null==t)return ae(e);const i=e.spatialReference,r=t.mode,s=(0,U.Ze)(t,i);let o=null;switch(n.type){case"2d":o=function(e,t,n){let{hasZ:i}=e;return"absolute-height"===t?i?e=>{let[t,i,r]=e;return[t,i,r+n]}:e=>{let[t,i]=e;return[t,i,n]}:null}(e,r,s);break;case"3d":o=function(e,t,n,i){let{spatialReference:r,hasZ:s}=e,{elevationProvider:o}=i;const a=(e,t,n,i)=>o?.getElevation(e,t,n,r,i)??0;switch(t){case"on-the-ground":return e=>{let[t,n]=e;return[t,n,a(t,n,0,"ground")]};case"absolute-height":return s?e=>{let[t,i,r]=e;return[t,i,r+n]}:e=>{let[t,i]=e;return[t,i,n]};case"relative-to-ground":return s?e=>{let[t,i,r]=e;return[t,i,r+a(t,i,r,"ground")+n]}:e=>{let[t,i]=e;return[t,i,a(t,i,0,"ground")+n]};case"relative-to-scene":return s?e=>{let[t,i,r]=e;return[t,i,r+a(t,i,r,"scene")+n]}:e=>{let[t,i]=e;return[t,i,a(t,i,0,"scene")+n]};default:return null}}(e,r,s,n)}return null==o?ae(e):new te.A({hasZ:!0,hasM:!1,spatialReference:i,paths:le(e.paths,o)})}function ae(e){return e.hasZ?new te.A({hasZ:!1,hasM:!1,spatialReference:e.spatialReference,paths:le(e.paths,e=>{let[t,n]=e;return[t,n]})}):e}function le(e,t){const n=e.length,i=new Array(n);for(let r=0;r<n;++r){const n=e[r],s=n.length,o=new Array(n.length);i[r]=o;for(let e=0;e<s;++e)o[e]=t(n[e])}return i}function ue(e){return pe(e)&&e.paths.some(e=>e.length>1)}function ce(e){return function(e){return he(e)&&pe(e?.geometry)}(e)&&ue(e.geometry)}function pe(e){return!he(e)&&null!=e&&"polyline"===e.type}function he(e){return null!=e&&"geometry"in e}function de(e){const t=e?.layer;return null!=t&&"graphics"===t.type&&t.internal}function ve(e,t,n,i,r){const{spatialReference:s,hasZ:o}=e,a={from:null,to:null,distance:0,azimuth:0,reverseAzimuth:0,spatialReference:s,metersPerSR:(0,w.GA)(s)},l=[],u=[];let c=0;for(let p=0;p<e.paths.length;++p){const s=e.paths[p],o=new Array,h=new Array;let d=0;for(let e=1;e<s.length;++e){const l=s[e-1],u=s[e],p=i(a,l,u);let v;for(v=d;v<p.distance&&!(0,W.Io)(v,p.distance);v+=t)o.push(r(p,v)),h.push((c+v)*n);d=v-p.distance,c+=p.distance,o.push(u),h.push(c*n)}l[p]=o,u[p]=h}return{densifiedPath:new te.A({spatialReference:s,hasZ:o,paths:l}),distances:u}}function ye(e,t,n){return e.distance=0,(0,ie._3)(e,t,n,e.spatialReference),e.from=t,e.to=n,e}function fe(e,t,n){return e.from=t,e.to=n,e.distance=(0,Y.Io)(n,t)*e.metersPerSR,e}function ge(e,t){let{from:n,azimuth:i,spatialReference:r}=e;return(0,ie.vN)([0,0],n,i,t,r)}function me(e,t){let{from:n,to:i,azimuth:r,distance:s,spatialReference:o}=e;const a=t/s,l=[0,0,(0,W.Cc)(n[2],i[2],a)];return(0,ie.vN)(l,n,r,t,o),l}function _e(e,t){let{from:n,to:i,distance:r}=e;return(0,Y.Cc)([0,0],n,i,t/r)}function we(e,t){let{from:n,to:i,distance:r}=e;return(0,ee.l)([0,0,0],n,i,t/r)}function xe(e){return e.paths.reduce((e,t)=>e+t.length,0)}function Ce(e,t,n){return xe(e)+Math.floor(t/n)+Math.max(0,e.paths.reduce(e=>1+e,0)-1)}function Me(e,t){const n=e.length;if(0===n)return null;const i=e[0],r=i.sampledZ;let s=r,o=r,a=0,l=0,u=null,c=null,p=null!=r?r:0,h=0,d=0,v=null!=r?1:0,y=0,f=0;const g=(0,w.GA)(t),m=(0,w.G9)(t),_=C().minSlopeSampleDistance/g,x=2*_,M=new Se,b=new Se,Z=()=>{S(),M.copy(b),b.reset()},P=(e,t)=>{Z(),e>0&&e-M.start<=x&&(e=M.start+_),b.restart(e,t)},S=()=>{if(M.isHole||b.isHole)return;const e=b.avgElevation-M.avgElevation,t=b.start-M.start,n=e*m,i=t*g,r=(0,w.oU)(Math.atan2(n,i),"radians","degrees");r>0?(h+=r,u=Ze(u,r),y++):r<0&&(d-=r,c=Ze(c,-r),f++)};null!=i.sampledZ&&P(i.distance,i.sampledZ);for(let w=1;w<n;++w){const t=e[w-1],n=e[w],i=n.sampledZ;if(null==i){b.isHole||Z();continue}v++,p+=i,s=be(s,i),o=Ze(o,i),b.isHole||n.distance-b.start>=_?P(n.distance,i):b.insert(i);const r=t.sampledZ;if(null!=r){const e=i-r;e>0?a+=e:e<0&&(l-=e)}}return Z(),0===v?null:{maxDistance:e[n-1].distance,minElevation:s,maxElevation:o,avgElevation:0===v?null:p/v,elevationGain:a,elevationLoss:l,maxPositiveSlope:u,maxNegativeSlope:c,avgPositiveSlope:0===y?null:h/y,avgNegativeSlope:0===f?null:d/f}}function be(e,t){return null==t?e:null!=e?Math.min(e,t):t}function Ze(e,t){return null==t?e:null!=e?Math.max(e,t):t}function Pe(e,t){return null!=e&&null!=t?e*t:null}class Se{constructor(){this._start=0,this._totalElevation=0,this._sampleCount=0}get avgElevation(){return this._totalElevation/this._sampleCount}get isHole(){return 0===this._sampleCount}get start(){return this._start}copy(e){this._start=e._start,this._sampleCount=e._sampleCount,this._totalElevation=e._totalElevation}reset(){this._start=0,this._sampleCount=0,this._totalElevation=0}restart(e,t){this._start=e,this._sampleCount=1,this._totalElevation=t}insert(e){++this._sampleCount,this._totalElevation+=e}}function Re(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];if(e>=t)return n;if(n.push(e),t-e<2)return n;const i=t-1;n.push(i);const r=ke(e+1,i);for(;;){const e=r.next();if(e.done)break;n.push(e.value)}return n}function*ke(e,t){if(e>=t)return;const n=e+Math.floor((t-e)/2);yield n;const i=ke(e,n),r=ke(n+1,t);for(;;){const e=i.next(),t=r.next();if(e.done&&t.done)break;e.done||(yield e.value),t.done||(yield t.value)}}var Ee=n(27243),Ae=n(59752);function*De(e,t){const{densificationResult:n}=e,i={...e,abortOptions:t,densificationResult:n},r=Re(0,i.result.samples.length),s=r.slice(0,i.provider.numSamplesForPreview);yield Ve(i,s,!0);const o=(0,D.Ho)(r,i.provider.numSamplesPerChunk);for(const a of o)yield Ve(i,a,!1)}async function Ve(e,t,n){let{densificationResult:i,result:r,provider:s,queue:o,abortOptions:a,cache:l}=e;const{densifiedPath:u,pathLength:c}=i,p=r.spatialReference,{samples:h}=r,d=[];for(let v=0;v<t.length;v++){const e=h[t[v]];d[v]=[...e.coordinate]}try{return await o.push({geometry:new X.A({spatialReference:p,points:d,hasZ:u.hasZ}),provider:s,indices:t,preview:n,result:r,parameters:{...C().defaultQueryOptions(),minDemResolution:n?Math.round(c/s.numSamplesForPreview):Math.round(c/h.length),cache:l}},a),{...r}}catch(se){return(0,L.zf)(se)?null:M}}function Te(e){return new Ee.F({priority:Ae.W6.ELEVATION_PROFILE,concurrency:1,scheduler:e,process:async e=>{(0,L.Te)(e.parameters);try{await async function(e){let{geometry:t,provider:n,indices:i,preview:r,result:s,parameters:o}=e;if(0===i.length)return;const a=(await async function(e,t,n){try{return await e.queryElevation(t,n)}catch(r){throw new N}}(n,t,o)).geometry,{hasZ:l,points:u}=a,c=o.noDataValue,{samples:p}=s;for(let h=0;h<i.length;h++){const e=p[i[h]];if(e.isHole)continue;const t=l?u[h][2]:null;null===t||t===c?e.sampledZ=null:(s.hasZ=!0,e.sampledZ=t),e.sampled=!0}(function(e){const t=e.length-1;let n=0;for(let i=1;i<=t;i++)(e[i].sampled||i===t)&&(Ge(e,n,i),n=i)})(p),s.progress=r?0:s.progress+i.length/p.length,s.statistics=Me(s.samples,s.spatialReference)}(e)}catch(t){(0,L.jH)(t)}}})}function Ge(e,t,n){if(n-t===1)return;const i=e[t],r=i.sampledZ,s=e[n],o=s.sampledZ;if(null==r||null==o){for(let i=t+1;i<n;i++)e[i].sampledZ=null;return}const a=i.distance,l=s.distance-a;for(let u=t+1;u<n;u++){const t=e[u],n=(t.distance-a)/l;t.sampledZ=(0,W.Cc)(r,o,n)}}function ze(e){let{densifiedPath:t,distances:n}=e;const i=t.spatialReference,r=(0,K.Vp)(i),s=t.paths,o=s.length,a=[];let l=null,u=0;for(let c=0;c<o;c++){const e=s[c],t=e.length,i=n[c];for(let n=0;n<t;n++){const t=e[n],s=i[n];r&&(t[0]=(0,J.N6)(t[0],r.valid[0],r.valid[1])),l&&0===n&&Ie(a,l,t,u,s),a.push(Oe(t,s)),l=t,u=s}}return{progress:0,samples:a,hasZ:!1,statistics:null,spatialReference:i}}function Ie(e,t,n,i,r){e.push(Le(t,i)),e.push(Le(n,r))}function Oe(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!1,isHole:!1}}function Le(e,t){return{coordinate:e,distance:t,sampledZ:null,sampled:!0,isHole:!0}}function qe(e){return e>.999999?1:e}let Ue=class extends h.A{constructor(e){super(e),this.error=null,this._getStableEffectiveUnits=T(()=>{const e=function(e){let t=null,n=null,i=null;for(const r of e){if(null==r)continue;const{statistics:e,spatialReference:s}=r;if(null==e)continue;const o=(0,w.GA)(s);t=Ze(t,Pe(e.maxDistance,o));const a=(0,w.G9)(s);i=be(i,Pe(e.minElevation,a)),n=Ze(n,Pe(e.maxElevation,a))}return{minDistance:0,maxDistance:t??0,minElevation:i??0,maxElevation:n??0}}(this._activeComputations.map(e=>e.result.rawResult)),t=this.analysis.displayUnits,n=(0,j.c)(this.view);return{distance:(0,w.Vs)(e.maxDistance,"meters",t.distance??n),elevation:(0,w.jE)(e.maxElevation,"meters",t.elevation??n)}},G.gh),this._updateTask=null,this._queue=null,this._currentTileCache=null,this._parametersPerComputation=new Map,this._getStableUpdateParameters=T(()=>({stationary:this.view.stationary??!0,activeComputations:this._activeComputations,generationParameters:this._generationParameters}),G.gh),this._getStableGenerationParameters=T(()=>{const{view:e,analysis:t}=this;return e?.ready&&this._queue?{view:e,geometry:t.geometry,geometryIsValid:t.valid,elevationInfo:this.elevationInfo,queue:this._queue,cache:this._tileCache,options:this._options,slicePlane:"3d"===e.type?e.slice.plane:null}:null},G.gh),this._getStableElevationInfo=T(()=>this.analysis.elevationInfo??je,O.CM),this._getStableOptions=T(()=>{const{densificationMaxSamples:e,defaultDemResolution:t,maxTotalSamples:n}=C();let i=this._minDemResolution??t;return i=parseFloat(i.toFixed(2)),{samplingDistance:i,densificationMaxSamples:Math.round(e/this._activeComputations.length),maxTotalSamples:n}},G.gh),this._updateThrottled=(0,g.n)(e=>this._update(e),C().updateThrottleMillis)}initialize(){this._computationsCollection=(0,I.L)(()=>this.analysis.profiles,e=>this.computationFactory.create({controller:this,profile:e,onInvalidate:e=>this._invalidateComputation(e)}),{recycleItems:!0}),this.addHandles([this._computationsCollection.on("change",()=>{this._parametersPerComputation.clear(),this._updateThrottled(this._updateParameters)}),(0,d.wB)(()=>this._updateParameters,e=>this._updateThrottled(e),d.pc),this._updateThrottled]);const e="3d"===this.view.type?this.view.resourceController:void 0;this._queue=Te(e?.scheduler),e?.addUpdatingObject(this)}destroy(){this._abortUpdate(),this._parametersPerComputation.clear(),this._computationsCollection?.destroy(),this._queue=(0,O.pR)(this._queue),this._currentTileCache=(0,O.pR)(this._currentTileCache)}get effectiveDisplayUnits(){return this._getStableEffectiveUnits()}get progress(){let e=0,t=0;for(const n of this._activeComputations)e++,t+=n.progress;return qe(e>0?t/e:0)}get updating(){const{progress:e}=this,t=!!this._queue?.updating,n=this._updateThrottled.hasPendingUpdates(),i=null!=this._updateTask&&!this._updateTask.finished;return t||n||i||e>0&&e<1}get results(){return this._computations.map(e=>e.result)}get statistics(){return function(e){const t=e.filter(D.Ru),n=t.length;if(0===n)return null;const i=t[0];if(1===n)return i;let r=i.maxDistance,s=i.minElevation,o=i.maxElevation,a=i.maxPositiveSlope,l=i.maxNegativeSlope;for(let u=1;u<t.length;++u){const e=t[u];r=Ze(r,e.maxDistance),s=be(s,e.minElevation),o=Ze(o,e.maxElevation),a=Ze(a,e.maxPositiveSlope),l=Ze(l,e.maxNegativeSlope)}return{maxDistance:r,minElevation:s,maxElevation:o,avgElevation:null,elevationGain:null,elevationLoss:null,maxPositiveSlope:a,maxNegativeSlope:l,avgPositiveSlope:null,avgNegativeSlope:null}}(this._activeComputations.map(e=>e.result.statistics))}get hoveredPoints(){return this._computations.map(e=>e.hoveredPoint)}onElevationChange(e){const{view:t}=this;return"3d"===t?.type?(0,d.on)(()=>t.elevationProvider,"elevation-change",e,{onListenerAdd:e,onListenerRemove:e}):(0,l.hA)()}get _tileCache(){this._currentTileCache=(0,O.pR)(this._currentTileCache);const e=this.view;if("3d"===e?.type){const t=e.basemapTerrain?.elevationQueryCache;if(null!=t)return t}return null==this._currentTileCache&&(this._currentTileCache=new q(new z.q(20971520))),this._currentTileCache}get _computations(){return this._computationsCollection?.toArray()??[]}get _activeComputations(){return this._computations.filter(e=>e.profile.enabled&&e.available)}get _minDemResolution(){const e=this._minDemResolutions;return e.length>0?(0,D.jk)(e):null}get _minDemResolutions(){const e=[];for(const{minDemResolution:t}of this._activeComputations)null!=t&&e.push(t);return e}get _updateParameters(){return this._getStableUpdateParameters()}get _generationParameters(){return this._getStableGenerationParameters()}get elevationInfo(){return this._getStableElevationInfo()}get _options(){return this._getStableOptions()}_update(e){let{stationary:t,activeComputations:n,generationParameters:i}=e;this._abortUpdate(),t&&(null!=i?this._updateTask=(0,V.UT)(async e=>{this.error=null;const t=n.filter(e=>!this._isComputationValid(e,i));try{if(!i.geometryIsValid)throw new B;const n=async function*(e,t){const{view:n,geometry:i,elevationInfo:r,providers:s,options:o}=e,a=n.spatialReference;if(!a||null==i||!ue(i))throw new B;const l=s.length;if(0===l)return null;const u=Math.round(o.maxTotalSamples/l);if(xe(i)>u)throw new $;const c=await re(i,r,n,a,o,u,t);(0,L.Te)(t);let p=0;const h=new Array(l),d=new Array(l);for(let f=0;f<l;f++){const n=ze(c);h[f]=n,p+=n.samples.length;const i={...e,provider:s[f],result:n,densificationResult:c};d[f]=De(i,t)[Symbol.iterator]()}if(p>o.maxTotalSamples)throw new $;const v=await Promise.all(d.map(e=>{const t=e.next();return!0===t.done?Promise.resolve(null):t.value}));(0,L.Te)(t);for(let f=0;f<l;f++)h[f]=v[f];yield h,await(0,L.Pl)(e.delayAfterPreview??C().delayAfterPreviewMillis,null,t.signal),(0,L.Te)(t);const y=[];try{let e;do{e=!1;for(let t=0;t<l;t++){const n=d[t].next();!1===n.done&&(y.push({resultPromise:n.value,index:t}),e=!0)}}while(e)}finally{d.forEach(e=>e.return?.())}for(const{resultPromise:f,index:g}of y)h[g]=await f,(0,L.Te)(t),yield h;for(const f of h)null!=f&&(f.progress=1);yield h}({...i,providers:t},{signal:e});let r=!1;for await(const s of n){(0,L.Te)(e),r||(this._clearInvalidResults(i),r=!0);for(let e=0;e<t.length;e++)t[e].setResult(s[e])}for(const e of t)this._parametersPerComputation.set(e,i)}catch(r){(0,L.QP)(r),this._abortUpdate(),this.error=r instanceof F?r:new Q,t.forEach(e=>{e.clearResult()})}}):this._clearResults())}_abortUpdate(){this._updateTask=(0,O.DC)(this._updateTask)}_isComputationValid(e,t){return this._parametersPerComputation.has(e)&&this._parametersPerComputation.get(e)===t}_invalidateComputation(e){this._parametersPerComputation.delete(e),this._updateThrottled(this._updateParameters)}_clearInvalidResults(e){for(const t of this._computations)this._isComputationValid(t,e)||(t.clearResult(),this._parametersPerComputation.delete(t))}_clearResults(){for(const e of this._computations)e.clearResult(),this._parametersPerComputation.delete(e)}};(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Ue.prototype,"analysis",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Ue.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Ue.prototype,"computationFactory",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Ue.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"error",void 0),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],Ue.prototype,"effectiveDisplayUnits",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"progress",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"updating",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"results",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"statistics",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"hoveredPoints",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_updateTask",void 0),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_queue",void 0),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_tileCache",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_computationsCollection",void 0),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_computations",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_activeComputations",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],Ue.prototype,"_minDemResolution",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_minDemResolutions",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_updateParameters",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_generationParameters",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"elevationInfo",null),(0,i.Cg)([(0,s.MZ)()],Ue.prototype,"_options",null),Ue=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileController")],Ue);const je=new H.A({...U.qt});var He=n(69098),Fe=n(56002),$e=n(19247);function Be(e,t,n){return null==e?null:(0,w.oU)(e*t,"meters",n)}function Ne(e,t,n){return null==e?null:(0,w.oU)(e*t,"meters",n)}let Qe=class extends He.Pw{constructor(e){super(e),this._getSamplesMemoized=(0,Fe.B)((e,t)=>function(e,t){if(null==e||null==t)return null;const{samples:n,spatialReference:i}=e,{distance:r,elevation:s}=t,o=(0,w.GA)(i),a=(0,w.G9)(i),l=n.length,u=new Array(l);for(let c=0;c<l;++c){const e=n[c],t=e.sampledZ,i=e.coordinate;u[c]={x:i[0],y:i[1],z:t,distance:Be(e.distance,o,r),elevation:Ne(t,a,s)}}return u}(e,t)),this._getStatisticsMemoized=(0,Fe.B)((e,t)=>function(e,t){if(null==e||null==t||null==e.statistics||null==e.spatialReference)return null;const{distance:n,elevation:i}=t,{statistics:r,spatialReference:s}=e,o=(0,w.GA)(s),a=(0,w.G9)(s);return{maxDistance:Be(r.maxDistance,o,n),minElevation:Ne(r.minElevation,a,i),maxElevation:Ne(r.maxElevation,a,i),avgElevation:Ne(r.avgElevation,a,i),elevationGain:Ne(r.elevationGain,a,i),elevationLoss:Ne(r.elevationLoss,a,i),maxPositiveSlope:r.maxPositiveSlope,maxNegativeSlope:r.maxNegativeSlope,avgPositiveSlope:r.avgPositiveSlope,avgNegativeSlope:r.avgNegativeSlope}}(e,t)),this.rawResult=null}get available(){const{computation:e}=this;return e.profile.enabled&&e.available}get profile(){return this.computation.profile}get progress(){return qe(null!=this.rawResult&&this.computation.profile.enabled?this.rawResult.progress:0)}get samples(){return this._getSamplesMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get statistics(){return this._getStatisticsMemoized(this.rawResult,this.computation.controller.effectiveDisplayUnits)}get hoveredPoint(){if(!this.computation.profile.enabled)return null;const e=this.computation.controller.analysisViewData.hoveredPosition;if(null==e)return null;const{rawResult:t,samples:n}=this;if(null==n||null==t)return null;const i=n.length;if(0===i)return null;const r=function(e,t,n){if(!e||0===e.length)return;const i=e.length-1,r=e[0];if(t<=n(r))return r;const s=e[i];if(t>=n(s))return s;let o=0,a=0,l=i;for(;o<l;){a=o+Math.floor((l-o)/2);const r=e[a],s=n(r);if(s===t)return r;if(t<s){if(a>0){const i=e[a-1],o=n(i);if(t>o)return t-o>=s-t?r:i}l=a}else{if(a<i){const i=e[a+1],o=n(i);if(t<o)return t-s>=o-t?i:r}o=a+1}}return e[a]}(n,e*n[i-1].distance,e=>e.distance);if(null==r)return null;const{x:s,y:o,z:a}=r;return null==a?null:new $e.A({x:s,y:o,z:a,spatialReference:t.spatialReference})}};(0,i.Cg)([(0,s.MZ)()],Qe.prototype,"available",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],Qe.prototype,"profile",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],Qe.prototype,"progress",null),(0,i.Cg)([(0,s.MZ)()],Qe.prototype,"samples",null),(0,i.Cg)([(0,s.MZ)()],Qe.prototype,"statistics",null),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],Qe.prototype,"computation",void 0),(0,i.Cg)([(0,s.MZ)()],Qe.prototype,"rawResult",void 0),(0,i.Cg)([(0,s.MZ)()],Qe.prototype,"hoveredPoint",null),Qe=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileResult")],Qe);let We=class extends h.A{constructor(e){super(e),this.result=new Qe({computation:this}),this.numSamplesForPreview=30,this.numSamplesPerChunk=200}initialize(){this.addHandles([(0,d.wB)(()=>{const{geometry:e,elevationInfo:t}=this.controller.analysis;return[e,t]},()=>this.onInvalidate(this),d.OH)])}setResult(e){this.result.rawResult=e}clearResult(){this.setResult(null)}get progress(){return this.result.progress}get hoveredPoint(){return this.result.hoveredPoint}get available(){return!0}get minDemResolution(){return C().defaultDemResolution}};(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],We.prototype,"controller",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],We.prototype,"profile",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],We.prototype,"onInvalidate",void 0),(0,i.Cg)([(0,s.MZ)()],We.prototype,"result",void 0),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],We.prototype,"progress",null),(0,i.Cg)([(0,s.MZ)()],We.prototype,"hoveredPoint",null),(0,i.Cg)([(0,s.MZ)()],We.prototype,"available",null),(0,i.Cg)([(0,s.MZ)()],We.prototype,"numSamplesForPreview",void 0),(0,i.Cg)([(0,s.MZ)()],We.prototype,"numSamplesPerChunk",void 0),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],We.prototype,"minDemResolution",null),We=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineComputation")],We);var Xe=n(97153);function Je(e){if(null==e)return null;if((0,Xe.Q)(e))return Ke(e);const t=e.tileInfo;if(null==t)return null;const n=t.lods?.at(-1);return null==n?null:n.resolution*(0,w.GA)(t.spatialReference)}function Ke(e){if(null==e)return null;const t=e.layers.items.map(Ye).filter(D.Ru);return(0,D.jk)(t)??null}function Ye(e){return e&&"tileInfo"in e?Je(e):null}let et=class extends We{constructor(){super(...arguments),this.type="ground",this.numSamplesForPreview=50,this.numSamplesPerChunk=1e3,this._getStableQueryElevationDependencies=T(()=>({ground:this._ground,groundLayers:this._getStableGroundLayers()}),G.gh),this._getStableGroundLayers=T(()=>this._ground?.layers?.toArray(),G.gh)}get minDemResolution(){return Ke(this._ground)}get available(){return!0===this._ground?.layers.some(e=>e.visible)}initialize(){this.addHandles([(0,d.wB)(()=>this._queryElevationDependencies,()=>this.onInvalidate(this))])}async queryElevation(e,t){const n=this._queryElevationDependencies;if(null==n)throw new Error(`${this.declaredClass}: no dependencies`);const{ground:i}=n;if(null==i)throw new Error("No ground configured in the view");const r=await i.queryElevation(e,t),s=(0,w.G9)(e.spatialReference),o=(0,w.G9)(i.layers.at(0).spatialReference);if(s!==o){const e=r.geometry;e.points=e.points.map(e=>{let[n,i,r]=e;return[n,i,r===t.noDataValue?r:r*o/s]})}return r}get _queryElevationDependencies(){return this._getStableQueryElevationDependencies()}get _ground(){return this.controller.view?.map?.ground}};(0,i.Cg)([(0,s.MZ)()],et.prototype,"minDemResolution",null),(0,i.Cg)([(0,s.MZ)()],et.prototype,"available",null),(0,i.Cg)([(0,s.MZ)()],et.prototype,"_queryElevationDependencies",null),(0,i.Cg)([(0,s.MZ)()],et.prototype,"_ground",null),et=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineGroundComputation")],et);var tt=n(62078);let nt=class extends We{constructor(){super(...arguments),this.type="input",this.numSamplesForPreview=50,this.numSamplesPerChunk=500,this._getStableElevationDependencies=T(()=>{const{view:e}=this.controller;if(!e)return null;const t=this._getStableElevationInfo();return{view:e,stationary:!this._requiresElevationAlignment||e.stationary,elevationInfo:t,visibleLayerIds:this._getStableLayerIds(),spatialReference:this._getStableSpatialReference()}},G.gh),this._getStableElevationInfo=T(()=>this.controller.elevationInfo,O.CM),this._getStableSpatialReference=T(()=>this.controller.view?.spatialReference,O.CM),this._getStableLayerIds=T(()=>{const{view:e}=this.controller;return"3d"!==e.type?[]:function(e){return e?.map?.allLayers?.toArray().filter(e=>("graphics"!==e.type||!e.internal)&&e.visible).map(e=>e.uid)??[]}(e)},G.gh)}initialize(){const e=()=>this.onInvalidate(this);this.addHandles([(0,d.wB)(()=>this._queryElevationDependencies,e,d.OH),this.controller.onElevationChange(e)])}async queryElevation(e,t){let{noDataValue:n,signal:i}=t;const r=this._queryElevationDependencies;if(null==r)throw new Error(`${this.declaredClass}: no dependencies`);const{view:s,spatialReference:o}=r;if(this._requiresElevationAlignment&&"3d"===s.type&&o){const t=await tt.q.fromGeometry(e).project(o,i);if(!t)return{geometry:e,noDataValue:n};const r=s.elevationProvider;return t.coordinates.forEach(e=>{e.z=r.getElevation(e.x,e.y,0,o,"ground")??0}),{geometry:t.export(),noDataValue:n}}return{geometry:e,noDataValue:n}}get _requiresElevationAlignment(){return"on-the-ground"===this.controller.elevationInfo?.mode&&"3d"===this.controller.view.type}get _queryElevationDependencies(){return this._getStableElevationDependencies()}};(0,i.Cg)([(0,s.MZ)()],nt.prototype,"_queryElevationDependencies",null),nt=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineInputComputation")],nt);let it=class extends We{constructor(){super(...arguments),this.type="query",this.numSamplesForPreview=50,this.numSamplesPerChunk=500}get minDemResolution(){return Je(this.profile.source)}get available(){const{source:e}=this.profile;return!!e&&(null==e.visible||e.visible)&&(null==e.layers||e.layers.some(e=>e.visible))}initialize(){this.addHandles((0,d.wB)(()=>this.profile.source,()=>this.onInvalidate(this),d.OH))}queryElevation(e,t){if(!this.profile.source)throw new Error("No source configured for the elevation profile line");return this.profile.source.queryElevation(e,t)}};(0,i.Cg)([(0,s.MZ)({readOnly:!0})],it.prototype,"minDemResolution",null),(0,i.Cg)([(0,s.MZ)()],it.prototype,"available",null),it=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileLineQueryComputation")],it);var rt=n(19451),st=n(7246),ot=n(75540);class at{constructor(){this._currentOperationSignal=(0,ot.v)(null)}get currentOperationType(){return this._currentOperationSignal.value?.type??null}destroy(){this.stop()}async start(e,t,n){const i=this._currentOperationSignal.value;i?.stop();const r=new AbortController,s=n?.signal,o=AbortSignal.any([r.signal,s].filter(D.Ru)),a=(0,L.Tw)();let u=!1;const c=()=>{u||(u=!0,a.reject((0,L.NK)()))},p={type:e,resolve:e=>{u||(u=!0,a.resolve(e))},reject:c,promise:a.promise,stop:()=>r.abort(),handles:[]};this._currentOperationSignal.value=p,p.handles.push((0,L.u7)(s,()=>{r.abort()}),(0,L.u7)(o,()=>{(0,l.a0)(p.handles),u||c()}));try{return i&&(await i.promise.catch(()=>{}),(0,L.Te)(o)),await t(p,o),await a.promise}finally{(0,l.a0)(p.handles),this._currentOperationSignal.value===p&&(this._currentOperationSignal.value=null)}}stop(){this._currentOperationSignal.value?.stop()}}var lt=n(57308),ut=n(81335),ct=n(80220);let pt=class extends h.A{constructor(e){super(e),this._sketchViewModels=new P.A,this._updatingHandles=new rt.U,this._operationManager=new at}initialize(){const{view:e}=this;this._graphicsLayer=new m.A({listMode:"hide",internal:!0}),this.addHandles([(0,d.wB)(()=>({map:e.map,internalGraphicsLayer:this._graphicsLayer,state:this.state,geometryVisualizationVisible:this._analysis.viewOptions.geometryVisualizationVisible,visible:this.analysisViewData.visible}),e=>{let{map:t,internalGraphicsLayer:n,state:i,geometryVisualizationVisible:r,visible:s}=e;!function(e,t){t&&(t.removeFromParent(),e?.add(t))}(t,n);const o=this.sketchGraphic;switch(o&&(o.visible=s),i){case"idle":case"reshaping-disabled":o&&!r&&(o.visible=!1),this._operationManager.stop(),this._ensureUpdatedSketchGraphic();break;case"reshaping":(0,L.QZ)(this._startReshape());break;case"awaiting-sketch":this.analysisViewData.interactive=!0}},d.pc),(0,d.wB)(()=>this._analysis.elevationInfo,e=>{this._graphicsLayer.elevationInfo=e},d.pc)])}destroy(){this._operationManager.destroy(),this._sketchViewModels.drain(e=>(0,O.pR)(e));const e=this._graphicsLayer;this.view.map?.remove(e),e.destroy()}get sketchGraphic(){return this._get("sketchGraphic")}set sketchGraphic(e){e!==this._get("sketchGraphic")&&(this._set("sketchGraphic",e),this._updateAnalysisFromSketchGraphic())}get state(){const{visible:e,interactive:t}=this.analysisViewData;if(!e)return"idle";switch(this._operationManager.currentOperationType){case"place":return this._sketching?"sketching":"awaiting-sketch";case"pick-feature":return"picking";default:return this._analysis.geometry?t?"reshaping":"reshaping-disabled":"idle"}}get updating(){return this._sketchViewModels.some(e=>e.updating)||this._updatingHandles.updating}get _sketching(){return this._sketchViewModels.some(e=>e.createGraphic===this.sketchGraphic)}get _analysis(){return this.analysisViewData.analysis}get _lineSymbol(){return function(e){if("2d"===e){const e={type:"CIMSolidStroke",enable:!0,capStyle:"Butt",joinStyle:"Round",width:1.5};return new _.A({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{...e,effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],color:[0,0,0,255]},{...e,color:[255,255,255,255]}]}}})}return new st.A({color:[0,0,0,0]})}(this.view.type)}place(e){return this._operationManager.start("place",async t=>{const n=this._createSketchViewModel(),i=this._analysis.clone();this._ensureUpdatedSketchGraphic();const r=this.sketchGraphic,s=this._analysis.elevationInfo,o=(0,l.hA)(()=>{this.sketchGraphic===r&&(this._graphicsLayer.elevationInfo=s)}),a=n.on("create",e=>{switch(e.state){case"start":this._graphicsLayer.removeAll(),this.sketchGraphic=e.graphic,this._analysis.elevationInfo=this._graphicsLayer.elevationInfo;break;case"active":this._updateAnalysisFromSketchGraphic();break;case"complete":this.sketchGraphic&&(this._updateAnalysisFromSketchGraphic(),this._addSketchGraphic(this.sketchGraphic)),t.stop();break;case"cancel":t.stop()}});t.handles.push(a,(0,l.hA)(()=>(a.remove(),n.destroy(),this._sketchViewModels.remove(n),this._updateAnalysisFromSketchGraphic(),this._analysis.valid?(0,L.G4)(e)||i.equals(this._analysis)?t.reject():void t.resolve({}):(this._clear(),t.reject()))),o),this._graphicsLayer.elevationInfo=ht,await this._updatingHandles.addPromise((0,L.QZ)(n.create("polyline")))},e)}async pickFeature(e){return this._operationManager.start("pick-feature",async e=>{const{view:t}=this;t.closePopup();let n=null;e.handles.push(t.on("immediate-click",i=>{i.defer(async()=>{n?.abort(),n=(0,V.UT)(async n=>{const{results:r}=await t.hitTest(i);(0,L.Te)(n);let s=null;for(const e of r)if("graphic"===e.type&&ce(e.graphic)&&!de(e.graphic)){s=e.graphic;break}s?(i.preventDefault(),i.stopPropagation(),this.sketchGraphic=null,this._analysis.geometry=s.geometry,this._analysis.elevationInfo=new H.A({...(0,U.bh)(s)}),e.resolve({feature:s}),e.stop()):e.reject()}),await n.promise})},lt.oj.TOOL),t.on("key-down",t=>{(0,ut.$X)(t)&&(e.reject(),e.stop())},lt.oj.TOOL),t.acquireCursor("crosshair","high"),(0,l.hA)(()=>{n?.abort(),e.reject()})),t.focus()},e)}_startReshape(){const e=this._createSketchViewModel();return this._sketchViewModels.add(e),this._operationManager.start("reshape",async t=>{const n=()=>{const t=this._ensureUpdatedSketchGraphic();return t?this._updatingHandles.addPromise(e.update(t,{tool:"reshape"})):Promise.resolve()};if(!this._ensureUpdatedSketchGraphic())return;const i=e.on("update",e=>{this._updateAnalysisFromSketchGraphic(),"complete"===e.state&&("reshaping"===this.state?(0,L.QZ)(n()):t.resolve())});t.handles.push(i,(0,l.hA)(()=>{i.remove(),this._sketchViewModels.remove(e),e.destroy(),t.resolve()})),await n()})}_createSketchViewModel(){return new ct.A({layer:this._graphicsLayer,view:this.view,defaultCreateOptions:{mode:"click",hasZ:!0},updateOnGraphicClick:!1,defaultUpdateOptions:{enableMoveAllGraphics:!1,enableRotation:!1,enableScaling:!1,enableZ:!1,highlightOptions:{enabled:!1},multipleSelectionEnabled:!1,reshapeOptions:{shapeOperation:"none"},toggleToolOnClick:!1,tool:"reshape"},polylineSymbol:this._lineSymbol,activeLineSymbol:this._lineSymbol})}_ensureUpdatedSketchGraphic(){const{geometry:e}=this._analysis;if(!e)return this.sketchGraphic=null,this._graphicsLayer.removeAll(),null;const t=this.sketchGraphic??=new y.A({symbol:this._lineSymbol,geometry:e});return t.geometry=e,this._addSketchGraphic(t),t}_addSketchGraphic(e){const{graphics:t}=this._graphicsLayer;t.includes(e)||t.add(e),1!==t.length&&t.removeMany(t.filter(t=>t!==e))}_clear(){this.sketchGraphic=null,this._analysis.clear()}_updateAnalysisFromSketchGraphic(){let e=this.sketchGraphic?.geometry;pe(e)||(e=null);const t=this._analysis;t.geometry!==e&&(t.geometry=e)}};(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],pt.prototype,"analysisViewData",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0})],pt.prototype,"view",void 0),(0,i.Cg)([(0,s.MZ)()],pt.prototype,"sketchGraphic",null),(0,i.Cg)([(0,s.MZ)({nonNullable:!0})],pt.prototype,"state",null),(0,i.Cg)([(0,s.MZ)()],pt.prototype,"updating",null),(0,i.Cg)([(0,s.MZ)()],pt.prototype,"_sketching",null),(0,i.Cg)([(0,s.MZ)()],pt.prototype,"_analysis",null),(0,i.Cg)([(0,s.MZ)()],pt.prototype,"_lineSymbol",null),pt=(0,i.Cg)([(0,o.$)("esri.views.analysis.ElevationProfile.ElevationProfileTool")],pt);const ht=new H.A({mode:"on-the-ground",offset:0});let dt=class extends p{constructor(e){super(e),this.type="elevation-profile-view-2d",this.analysis=null,this.hoveredPosition=null}initialize(){const{analysis:e,view:t}=this;this._controller=new Ue({analysis:e,analysisViewData:this,view:t,computationFactory:{create:e=>{switch(e.profile.type){case"ground":return new et(e);case"input":return new nt(e);case"query":return new it(e);case"scene":throw new r.A("elevation-profile-analysis-view-2d:unsupported","The scene profile line type is not supported in 2D views.")}}}}),this._visualization=new A({view:t,analysisViewData:this}),this._sketchTool=new pt({view:t,analysisViewData:this})}destroy(){this._controller?.destroy(),this._visualization?.destroy(),this._sketchTool?.destroy()}get effectiveDisplayUnits(){return this._controller?.effectiveDisplayUnits??{distance:"meters",elevation:"meters"}}get error(){return this._controller?.error}get hoveredPoints(){return this._controller?.hoveredPoints??[]}get interactive(){return super.interactive}set interactive(e){super.interactive=e}get progress(){return this._controller?.progress??0}get results(){return this._controller?.results??[]}get statistics(){return this._controller?.statistics}get updating(){return!0===this._controller?.updating||!0===this._visualization?.updating||!0===this._sketchTool?.updating}get visible(){return super.visible}set visible(e){super.visible=e}get sketchGraphic(){return this._sketchTool?.sketchGraphic}get toolState(){return this._sketchTool?.state??"idle"}place(e){return this._sketchTool.place(e)}pickFeature(e){return this._sketchTool.pickFeature(e)}};(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"type",void 0),(0,i.Cg)([(0,s.MZ)({constructOnly:!0,nonNullable:!0})],dt.prototype,"analysis",void 0),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"effectiveDisplayUnits",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"error",null),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"hoveredPosition",void 0),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"hoveredPoints",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"progress",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"results",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"statistics",null),(0,i.Cg)([(0,s.MZ)({readOnly:!0})],dt.prototype,"updating",null),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"sketchGraphic",null),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"toolState",null),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"_controller",void 0),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"_visualization",void 0),(0,i.Cg)([(0,s.MZ)()],dt.prototype,"_sketchTool",void 0),dt=(0,i.Cg)([(0,o.$)("esri.views.2d.analysis.ElevationProfileAnalysisView2D")],dt);const vt=dt},60008:(e,t,n)=>{n.d(t,{A6:()=>f,B8:()=>d,Xd:()=>c,Xr:()=>v,Yc:()=>A,hZ:()=>m,lw:()=>p,t2:()=>k,x8:()=>u});var i=n(44680),r=n(4336),s=n(9392),o=n(53494),a=n(20664),l=n(43047);function u(e,t,n){n*=.5;const i=Math.sin(n);return e[0]=i*t[0],e[1]=i*t[1],e[2]=i*t[2],e[3]=Math.cos(n),e}function c(e,t){const n=2*Math.acos(t[3]),i=Math.sin(n/2);return i>(0,o.FD)()?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=1,e[1]=0,e[2]=0),n}function p(e,t,n){const i=t[0],r=t[1],s=t[2],o=t[3],a=n[0],l=n[1],u=n[2],c=n[3];return e[0]=i*c+o*a+r*u-s*l,e[1]=r*c+o*l+s*a-i*u,e[2]=s*c+o*u+i*l-r*a,e[3]=o*c-i*a-r*l-s*u,e}function h(e,t,n,i){const r=t[0],s=t[1],a=t[2],l=t[3];let u,c,p,h,d,v=n[0],y=n[1],f=n[2],g=n[3];return c=r*v+s*y+a*f+l*g,c<0&&(c=-c,v=-v,y=-y,f=-f,g=-g),1-c>(0,o.FD)()?(u=Math.acos(c),p=Math.sin(u),h=Math.sin((1-i)*u)/p,d=Math.sin(i*u)/p):(h=1-i,d=i),e[0]=h*r+d*v,e[1]=h*s+d*y,e[2]=h*a+d*f,e[3]=h*l+d*g,e}function d(e,t){const n=t[0],i=t[1],r=t[2],s=t[3],o=n*n+i*i+r*r+s*s,a=o?1/o:0;return e[0]=-n*a,e[1]=-i*a,e[2]=-r*a,e[3]=s*a,e}function v(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e}function y(e,t){const n=t[0]+t[4]+t[8];let i;if(n>0)i=Math.sqrt(n+1),e[3]=.5*i,i=.5/i,e[0]=(t[5]-t[7])*i,e[1]=(t[6]-t[2])*i,e[2]=(t[1]-t[3])*i;else{let n=0;t[4]>t[0]&&(n=1),t[8]>t[3*n+n]&&(n=2);const r=(n+1)%3,s=(n+2)%3;i=Math.sqrt(t[3*n+n]-t[3*r+r]-t[3*s+s]+1),e[n]=.5*i,i=.5/i,e[3]=(t[3*r+s]-t[3*s+r])*i,e[r]=(t[3*r+n]+t[3*n+r])*i,e[s]=(t[3*s+n]+t[3*n+s])*i}return e}function f(e,t,n,i){const r=.5*Math.PI/180;t*=r,n*=r,i*=r;const s=Math.sin(t),o=Math.cos(t),a=Math.sin(n),l=Math.cos(n),u=Math.sin(i),c=Math.cos(i);return e[0]=s*l*c-o*a*u,e[1]=o*a*c+s*l*u,e[2]=o*l*u-s*a*c,e[3]=o*l*c+s*a*u,e}const g=l.d,m=l.s,_=l.h,w=p,x=l.c,C=l.g,M=l.l,b=l.i,Z=b,P=l.b,S=P,R=l.n,k=l.a,E=l.e;function A(e,t,n){const i=(0,a.f)(t,n);return i<-.999999?((0,a.i)(D,V,t),(0,a.H)(D)<1e-6&&(0,a.i)(D,T,t),(0,a.n)(D,D),u(e,D,Math.PI),e):i>.999999?(e[0]=0,e[1]=0,e[2]=0,e[3]=1,e):((0,a.i)(D,t,n),e[0]=D[0],e[1]=D[1],e[2]=D[2],e[3]=1+i,R(e,e))}const D=(0,s.vt)(),V=(0,s.fA)(1,0,0),T=(0,s.fA)(0,1,0);const G=(0,r.vt)(),z=(0,r.vt)();const I=(0,i.vt)();Object.freeze(Object.defineProperty({__proto__:null,add:_,calculateW:function(e,t){const n=t[0],i=t[1],r=t[2];return e[0]=n,e[1]=i,e[2]=r,e[3]=Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e},conjugate:v,copy:g,dot:C,equals:E,exactEquals:k,fromEuler:f,fromMat3:y,getAxisAngle:c,identity:function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},invert:d,len:Z,length:b,lerp:M,mul:w,multiply:p,normalize:R,random:function(e){const t=o.Ov,n=t(),i=t(),r=t(),s=Math.sqrt(1-n),a=Math.sqrt(n);return e[0]=s*Math.sin(2*Math.PI*i),e[1]=s*Math.cos(2*Math.PI*i),e[2]=a*Math.sin(2*Math.PI*r),e[3]=a*Math.cos(2*Math.PI*r),e},rotateX:function(e,t,n){n*=.5;const i=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);return e[0]=i*l+o*a,e[1]=r*l+s*a,e[2]=s*l-r*a,e[3]=o*l-i*a,e},rotateY:function(e,t,n){n*=.5;const i=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);return e[0]=i*l-s*a,e[1]=r*l+o*a,e[2]=s*l+i*a,e[3]=o*l-r*a,e},rotateZ:function(e,t,n){n*=.5;const i=t[0],r=t[1],s=t[2],o=t[3],a=Math.sin(n),l=Math.cos(n);return e[0]=i*l+r*a,e[1]=r*l-i*a,e[2]=s*l+o*a,e[3]=o*l-s*a,e},rotationTo:A,scale:x,set:m,setAxes:function(e,t,n,i){const r=I;return r[0]=n[0],r[3]=n[1],r[6]=n[2],r[1]=i[0],r[4]=i[1],r[7]=i[2],r[2]=-t[0],r[5]=-t[1],r[8]=-t[2],R(e,y(e,r))},setAxisAngle:u,slerp:h,sqlerp:function(e,t,n,i,r,s){return h(G,t,r,s),h(z,n,i,s),h(e,G,z,2*s*(1-s)),e},sqrLen:S,squaredLength:P,str:function(e){return"quat("+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+")"}},Symbol.toStringTag,{value:"Module"}))},62078:(e,t,n)=>{n.d(t,{q:()=>a});var i=n(66388),r=n(19247),s=n(23701),o=n(56611);class a{constructor(e){this.geometry=e,this.spatialReference=e.spatialReference}export(){return this._exporter(this.coordinates,this.spatialReference)}clone(e){const t=new a(this.geometry);return t.spatialReference=this.spatialReference,t.coordinates=e??this.coordinates.map(e=>e.clone()),t._exporter=this._exporter,t}async project(e,t){if(this.spatialReference.equals(e))return this.clone();await(0,o.initializeProjection)([{source:this.spatialReference,dest:e}],{signal:t});const n=new i.A({spatialReference:this.spatialReference,points:this.coordinates.map(e=>[e.x,e.y])}),r=(0,o.project)(n,e);if(!r)return null;const s=this.coordinates.map((e,t)=>{const n=e.clone(),i=r.points[t];return n.x=i[0],n.y=i[1],n}),a=this.clone(s);return a.spatialReference=e,a}static fromGeometry(e){const t=new a(e);if(e instanceof a)return t.coordinates=e.coordinates.map(e=>e.clone()),t._exporter=(t,n)=>{const i=e.clone(t);return i.spatialReference=n,i},t;switch(e.type){case"point":{const n=e,{hasZ:i,hasM:s}=n;return t.coordinates=i&&s?[new l(n.x,n.y,n.z,n.m)]:i?[new l(n.x,n.y,n.z)]:s?[new l(n.x,n.y,null,n.m)]:[new l(n.x,n.y)],t._exporter=(t,n)=>e.hasM?new r.A(t[0].x,t[0].y,t[0].z,t[0].m,n):new r.A(t[0].x,t[0].y,t[0].z,n),t}case"multipoint":{const n=e,{hasZ:r,hasM:s}=n;return t.coordinates=r&&s?n.points.map(e=>new l(e[0],e[1],e[2],e[3])):r?n.points.map(e=>new l(e[0],e[1],e[2])):s?n.points.map(e=>new l(e[0],e[1],null,e[2])):n.points.map(e=>new l(e[0],e[1])),t._exporter=(t,n)=>e.hasM?new i.A({points:t.map(e=>[e.x,e.y,e.z??0,e.m??0]),hasZ:!0,hasM:!0,spatialReference:n}):new i.A({points:t.map(e=>[e.x,e.y,e.z??0]),spatialReference:n}),t}case"polyline":{const n=e,i=[],r=[],{hasZ:o,hasM:a}=e;let u=0;for(const e of n.paths)if(r.push([u,u+e.length]),u+=e.length,o&&a)for(const t of e)i.push(new l(t[0],t[1],t[2],t[3]));else if(o)for(const t of e)i.push(new l(t[0],t[1],t[2]));else if(a)for(const t of e)i.push(new l(t[0],t[1],null,t[2]));else for(const t of e)i.push(new l(t[0],t[1]));return t.coordinates=i,t._exporter=(t,n)=>{const i=e.hasM?t.map(e=>[e.x,e.y,e.z??0,e.m??0]):t.map(e=>[e.x,e.y,e.z??0]),o=r.map(e=>i.slice(e[0],e[1]));return new s.A({paths:o,hasM:e.hasM,hasZ:!0,spatialReference:n})},t}}}}class l{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;this.x=e,this.y=t,this.z=n,this.m=i,this.tile=r,this.elevationTile=s}clone(){return new l(this.x,this.y,this.z,this.m)}}},79468:(e,t,n)=>{n.d(t,{n:()=>r});var i=n(75540);function r(e,t,n,r){let s=null,o=1e3;"number"==typeof t?(o=t,r=n):(s=t??null,o=n);const a=(0,i.v)(0);let l;const u=()=>{a.value=0,e.apply(r,l)},c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];s&&s.apply(r,t),l=t,o?a.value||(a.value=setTimeout(u,o)):u()};return c.remove=()=>{a.value&&(clearTimeout(a.value),a.value=0)},c.forceUpdate=()=>{a.value&&(clearTimeout(a.value),u())},c.hasPendingUpdates=()=>!!a.value,c}}}]);
//# sourceMappingURL=4030.b8b5b20a.chunk.js.map